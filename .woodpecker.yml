#clone:
  # git:
  #   image: woodpeckerci/plugin-git
  #   # necesario para el entorno docker-compose
  #   # de lo contrario los agentes no pueden acceder al servidor gitea local
  #   network_mode: host
  #   privileged: true

pipeline:
  tests:
    image: python:3.9
    environment:
      - DB_CACHE=/tmp
      - DB_NAME=trytontest
      - TRYTOND_DATABASE_URI=postgresql://tryton:tryton@postgres:5432/
    commands:
      - cd party_ciiu
      - pip3 install psycopg2 proteus
      - python3 setup.py install
      - python3 -m unittest

services:
  postgres:
    image: postgres:12
    environment:
      - POSTGRES_USER=tryton
      - POSTGRES_PASSWORD=tryton
      - POSTGRES_DB=demo
